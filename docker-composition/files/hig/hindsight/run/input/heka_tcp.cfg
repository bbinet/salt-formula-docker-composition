filename = "heka_tcp.lua"
instruction_limit = 0

-- Override of default sandbox configuration variables
{%- for key in ['output_limit', 'memory_limit', 'preserve_data', 'restricted_headers', 'ticker_interval', 'shutdown_on_terminate'] %}
{%- if key in cfg %}
{{ key }} = {{ cfg[key] }}
{%- endif %}
{%- endfor %}

address = "{{ cfg.get('address', '0.0.0.0') }}"
port = "{{ cfg.get('port', 5565) }}"

{%- set ssl = cfg.get('ssl_params', False) %}
{%- if ssl %}
ssl_params = {
  mode = "server",
  protocol = "tlsv1",
  key = "{{ ssl['key'] }}",
  certificate = "{{ ssl['certificate'] }}",
  cafile = "{{ ssl['cafile'] }}",
  verify = {"peer", "fail_if_no_peer_cert"}
}
{%- endif %}
